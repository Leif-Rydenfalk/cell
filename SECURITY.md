Generated by Gemini 3.0:
Here is the security and architectural documentation for the Cell Economy (Mitochondria) system.

---

# Cell Network: Economic Security & Roadmap to Standardization

**Version:** 0.2.0 (Prototype)
**Status:** Functional Local Mesh / Trusted Network
**Author:** Cell Core Team

## 1. Current Security Posture (The "Trusted Mesh" State)

As of the implementation of the `mitochondria` and `antigens` modules, the Cell network operates on a **"Trusted Mesh"** model. It provides strong encryption and identity verification but relies on "gentlemen's agreements" regarding the validity of work and the honesty of the ledger.

### A. Transport Security (Strong)
We utilize the **Noise Protocol Framework** (`Noise_XX_25519_ChaChaPoly_BLAKE2s`) via the `synapse` module.
*   **Mutual Authentication:** Every connection is mutually authenticated. Client and Server verify each other's public keys (`antigens`).
*   **Forward Secrecy:** Ephemeral keys are generated for every session. If a private key is compromised later, past traffic cannot be decrypted.
*   **Identity Pinning:** The Mitochondria ledger records transactions against the base64-encoded Public Key of the peer, ensuring billing is tied to cryptographic identity, not spoofable IP addresses.

### B. Process Isolation (Moderate)
We utilize Linux **Control Groups (cgroups v2)** via the `nucleus` module.
*   **Resource Containment:** We successfully limit RAM usage (`memory.max`) to prevent a job from crashing the host via OOM (Out Of Memory).
*   **Billing Accuracy:** We track CPU time and Wall time to calculate ATP costs.
*   **Gap:** While cgroups limit *resources*, they do not fully isolate the *filesystem* or *namespace*. A malicious binary sent to a donor node could currently read files from the host system if not running as a dedicated user.

### C. Economic Integrity (Weak / Local Trust Only)
The current `mitochondria.json` ledger is **Local-Only**.
*   **Pros:** Extremely fast, zero network overhead, works offline or in partitioned LANs.
*   **Cons:**
    *   **Mutability:** A user can edit their local `mitochondria.json` to give themselves infinite ATP.
    *   **Double Spend:** There is no global consensus. A node can spend 5 ATP with Peer A and the same 5 ATP with Peer B because Peer A and B do not talk to verify the balance.
    *   **Counter-Party Risk:** The donor calculates the bill. A malicious donor could edit the code to charge 1000 ATP for 1ms of work.

---

## 2. The Road to Internet Standard (Implementation Roadmap)

To evolve Cell from a LAN-based mesh into the **Global Compute Substrate**, we must move from a "Trusted Mesh" to a "Trustless Network."

The following four pillars must be implemented:

### Pillar I: The Capability Sandbox (WASM / Firecracker)
Currently, we execute native Linux binaries (`ELF`). This is unsafe for a public network.
*   **The Problem:** Running arbitrary code from the internet allows malicious actors to execute ransomware or reverse shells on donor machines.
*   **The Solution:**
    1.  **WebAssembly (WASM):** Migrate the `nucleus` to execute `.wasm` modules using a runtime like **Wasmtime**. This provides a mathematically proven sandbox where code cannot access the host filesystem or network unless explicitly granted capabilities (WASI).
    2.  **MicroVMs:** For workloads that require Linux kernels (e.g., Docker containers), integration with **Firecracker** (KVM) is required to wrap the process in a disposable Virtual Machine.

### Pillar II: Verifiable Computing (Proof-of-Correctness)
Currently, a donor sends back a result, and the buyer pays. The donor could simply return `0` immediately to save electricity and still claim the reward.
*   **The Solution:**
    1.  **Replication (Consensus):** The Coordinator sends the same job to 3 different Donors. The results are compared. If 2 match and 1 differs, the outlier is slashed (reputation penalty) and the majority are paid.
    2.  **Zk-STARKs (Long Term):** Implement Zero-Knowledge Proofs where the computation generates a cryptographic proof that the code was executed correctly.

### Pillar III: Distributed Settlement (Global Ledger)
Currently, ATP is just a local score. It needs to be a transferable asset.
*   **The Solution:**
    1.  **Layer 2 Blockchain Integration:** Periodically, nodes must "settle" their local ledgers to a global state (e.g., Solana, Polygon, or a custom Cell-Chain).
    2.  **State Channels:** Use the Lightning Network model. Peers open a payment channel (locking assets on-chain) and exchange thousands of ATP transactions off-chain instantly. Only the final net difference is written to the blockchain.
    3.  **Cryptographic Signatures:** Every transaction in `mitochondria` must be signed by the spender's private key. This prevents a node from falsely claiming "Alice paid me 50 ATP."

### Pillar IV: Content-Addressed Supply Chain
Currently, we download binaries or source code via git/http.
*   **The Problem:** DNS hijacking or GitHub compromise could inject malicious code into the compilation step.
*   **The Solution:**
    1.  **IPFS / Content Addressing:** Code should be fetched by its **Hash** (CID), not its location. `call_as!(worker, ...)` should resolve to a specific immutable hash of the worker code.
    2.  **Signed Genomes:** Cell Genomes (`genome.toml`) must be cryptographically signed by the author. The runtime should refuse to spawn a cell if the signature does not match the trusted developer's key.

---

## 3. Immediate Next Steps (v0.3.0)

To prepare for these major shifts, the next immediate engineering tasks are:

1.  **Signature Enforcement:** Update `mitochondria.rs` so that `synthesize_atp` requires a cryptographic signature from the payer.
2.  **WASM Prototype:** Create a `nucleus-wasm` adapter to run a simple Rust function compiled to `wasm32-wasi` instead of a native binary.
3.  **Reputation Tracker:** Add a `reputation` field to the `peers` map in Golgi. Track success/failure rates of jobs. Prefer high-reputation nodes for tasks.

By implementing these standards, Cell will shift from a tool for orchestrating local microservices to a global, decentralized market for computeâ€”effectively becoming the "Airbnb for CPU cycles."